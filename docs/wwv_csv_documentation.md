# Phoenix SDR WWV CSV Log File Documentation

> ✅ **CURRENT** - CSV log format documentation is accurate

This document describes all CSV log files generated by the Phoenix SDR WWV waterfall application.

---

## wwv_ticks.csv

**Purpose:** Primary tick pulse detection log. Records every detected 5ms tick pulse at 1000 Hz.

**Generator:** `tick_detector.c`

### Header Comments
```
# Phoenix SDR WWV Tick Log v{version}
# Started: {datetime}
```

### Fields

| Field | Type | Description |
|-------|------|-------------|
| `time` | HH:MM:SS | Wall clock time of detection |
| `timestamp_ms` | float | Milliseconds since detector start |
| `tick_num` | int/string | Sequential tick number, or `M1`, `M2`... for minute markers, or `GAIN`/`META` for metadata |
| `expected` | string | WWV clock expected event: `TICK`, `VOICE`, `SILENCE`, `MARKER` |
| `energy_peak` | float | Peak 1000 Hz bucket energy during pulse |
| `duration_ms` | float | Pulse duration in milliseconds |
| `interval_ms` | float | Time since previous tick (0 for first tick) |
| `avg_interval_ms` | float | Running average interval over recent ticks |
| `noise_floor` | float | Adaptive noise floor estimate |
| `corr_peak` | float | Peak matched filter correlation value |
| `corr_ratio` | float | Correlation peak / correlation noise floor ratio |

### Special Rows
- **Minute markers:** `tick_num` = `M1`, `M2`, etc. (duration 600-900ms)
- **Metadata:** `tick_num` = `META` with RF settings in `expected` field
- **Gain changes:** `tick_num` = `GAIN` with display gain in `expected` field

---

## wwv_markers.csv

**Purpose:** Dedicated minute marker detection using sliding window energy accumulator. Detects 800ms pulses at second 0 of each minute.

**Generator:** `marker_detector.c`

### Header Comments
```
# Phoenix SDR WWV Marker Log v{version}
# Started: {datetime}
# Sliding window: {N} frames ({ms} ms)
```

### Fields

| Field | Type | Description |
|-------|------|-------------|
| `time` | HH:MM:SS | Wall clock time of detection |
| `timestamp_ms` | float | Milliseconds since detector start |
| `marker_num` | string | `M1`, `M2`, etc., or `GAIN`/`META` for metadata |
| `wwv_sec` | int | WWV clock second (should be 0-2 for valid markers) |
| `expected` | string | WWV clock expected event at detection time |
| `accum_energy` | float | Accumulated energy over sliding window |
| `duration_ms` | float | Marker duration in milliseconds |
| `since_last_sec` | float | Seconds since previous marker (expect ~60.0) |
| `baseline` | float | Adaptive baseline energy level |
| `threshold` | float | Detection threshold (baseline × 3.0) |

---

## wwv_sync.csv

**Purpose:** Correlates tick and marker detections to establish time synchronization state.

**Generator:** `sync_detector.c`

### Header Comments
```
# Phoenix SDR WWV Sync Log v{version}
# Started: {datetime}
```

### Fields

| Field | Type | Description |
|-------|------|-------------|
| `time` | HH:MM:SS | Wall clock time |
| `timestamp_ms` | float | Milliseconds since detector start |
| `marker_num` | int | Confirmed marker count |
| `state` | string | Sync state: `SEARCHING`, `TENTATIVE`, `LOCKED` |
| `interval_sec` | float | Interval between markers in seconds |
| `delta_ms` | float | Time delta between tick marker and marker detector |
| `tick_dur_ms` | float | Duration from tick detector |
| `marker_dur_ms` | float | Duration from marker detector |

---

## wwv_tick_corr.csv

**Purpose:** Tick correlation database for chain analysis. Groups ticks into chains based on consistent ~1000ms intervals.

**Generator:** `tick_correlator.c`

### Header Comments
```
# Phoenix SDR WWV Tick Correlation Database v{version}
# Started: {datetime}
# Correlation window: 900-1050 ms
```

### Fields

| Field | Type | Description |
|-------|------|-------------|
| `time` | HH:MM:SS | Wall clock time |
| `timestamp_ms` | float | Milliseconds since start |
| `tick_num` | int | Tick number |
| `expected` | string | WWV expected event |
| `energy_peak` | float | Peak energy |
| `duration_ms` | float | Pulse duration |
| `interval_ms` | float | Interval from previous tick |
| `avg_interval_ms` | float | Running average interval |
| `noise_floor` | float | Noise floor estimate |
| `corr_peak` | float | Correlation peak |
| `corr_ratio` | float | Correlation ratio |
| `chain_id` | int | Chain identifier (increments on breaks) |
| `chain_pos` | int | Position within current chain |
| `chain_start_ms` | float | Timestamp of chain start |
| `drift_ms` | float | Cumulative timing drift from expected 1000ms |

---

## wwv_channel.csv

**Purpose:** Overall channel quality assessment logged every ~1 second.

**Generator:** `waterfall.c`

### Header Comments
```
# Phoenix SDR WWV Channel Log v{version}
```

### Fields

| Field | Type | Description |
|-------|------|-------------|
| `time` | HH:MM:SS | Wall clock time |
| `timestamp_ms` | float | Milliseconds since start |
| `carrier_db` | float | DC/carrier power in dB |
| `snr_db` | float | Signal-to-noise ratio (1000Hz tone - noise floor) |
| `sub500_db` | float | 500 Hz subcarrier power in dB |
| `sub600_db` | float | 600 Hz subcarrier power in dB |
| `tone1000_db` | float | 1000 Hz tick tone power in dB |
| `noise_db` | float | Estimated noise floor in dB |
| `quality` | string | Channel quality: `GOOD` (SNR>15), `FAIR` (8-15), `POOR` (3-8), `NONE` (<3) |

---

## wwv_subcarrier.csv

**Purpose:** Tracks 500/600 Hz subcarrier presence and validates against WWV schedule.

**Generator:** `waterfall.c`

### Header Comments
```
# Phoenix SDR WWV Subcarrier Log v{version}
# Started: {datetime}
```

### Fields

| Field | Type | Description |
|-------|------|-------------|
| `time` | HH:MM:SS | Wall clock time |
| `timestamp_ms` | float | Milliseconds since start |
| `minute` | int | Current minute of the hour (0-59) |
| `expected` | string | Expected subcarrier per WWV schedule: `500Hz`, `600Hz`, or `NONE` |
| `sub500_db` | float | Measured 500 Hz power in dB |
| `sub600_db` | float | Measured 600 Hz power in dB |
| `delta_db` | float | Difference: sub500_db - sub600_db |
| `detected` | string | Which tone detected: `500Hz`, `600Hz`, or `NONE` (based on ±3dB threshold) |
| `match` | string | Does detected match expected? `YES`, `NO`, or `-` (if expected=NONE) |

---

## wwv_carrier.csv

**Purpose:** High-precision carrier frequency tracking for receiver calibration. Measures DC offset which indicates tuning error.

**Generator:** `tone_tracker.c` (configured for 0 Hz)

### Header Comments
```
# Phoenix SDR WWV Tone Tracker (0 Hz) v{version}
# Started: {datetime}
# FFT: {size}-pt, {hz_per_bin} Hz/bin, {frame_ms} ms frame
```

### Fields

| Field | Type | Description |
|-------|------|-------------|
| `time` | HH:MM:SS | Wall clock time |
| `timestamp_ms` | float | Milliseconds since start |
| `measured_hz` | float | Measured frequency offset from nominal |
| `offset_hz` | float | Same as measured_hz (frequency error) |
| `offset_ppm` | float | Frequency error in parts per million (relative to 100 kHz reference) |
| `snr_db` | float | Signal-to-noise ratio of the carrier |
| `valid` | string | `YES` if measurement is reliable, `NO` if below SNR threshold |

### Notes
- Typical offset: 9-10 Hz indicates receiver is tuned ~10 Hz low
- PPM values ~96-100 indicate ~10 Hz error at 10 MHz (or equivalent)

---

## wwv_tone_500.csv

**Purpose:** Tracks the 500 Hz subcarrier frequency and stability.

**Generator:** `tone_tracker.c` (configured for 500 Hz)

### Header Comments
```
# Phoenix SDR WWV Tone Tracker (500 Hz) v{version}
# Started: {datetime}
# FFT: {size}-pt, {hz_per_bin} Hz/bin, {frame_ms} ms frame
```

### Fields

| Field | Type | Description |
|-------|------|-------------|
| `time` | HH:MM:SS | Wall clock time |
| `timestamp_ms` | float | Milliseconds since start |
| `measured_hz` | float | Actual measured frequency |
| `offset_hz` | float | Deviation from 500 Hz nominal |
| `offset_ppm` | float | Offset in parts per million |
| `snr_db` | float | Signal-to-noise ratio |
| `valid` | string | `YES` if tone detected with sufficient SNR, `NO` otherwise |

### Notes
- 500 Hz subcarrier is broadcast during specific minutes per WWV schedule
- `valid=NO` expected when 600 Hz subcarrier is active instead

---

## wwv_tone_600.csv

**Purpose:** Tracks the 600 Hz subcarrier frequency and stability.

**Generator:** `tone_tracker.c` (configured for 600 Hz)

### Header Comments
```
# Phoenix SDR WWV Tone Tracker (600 Hz) v{version}
# Started: {datetime}
# FFT: {size}-pt, {hz_per_bin} Hz/bin, {frame_ms} ms frame
```

### Fields

| Field | Type | Description |
|-------|------|-------------|
| `time` | HH:MM:SS | Wall clock time |
| `timestamp_ms` | float | Milliseconds since start |
| `measured_hz` | float | Actual measured frequency |
| `offset_hz` | float | Deviation from 600 Hz nominal |
| `offset_ppm` | float | Offset in parts per million |
| `snr_db` | float | Signal-to-noise ratio |
| `valid` | string | `YES` if tone detected with sufficient SNR, `NO` otherwise |

### Notes
- 600 Hz subcarrier is broadcast during specific minutes per WWV schedule
- `valid=NO` expected when 500 Hz subcarrier is active instead

---

## WWV Subcarrier Schedule Reference

The 500 Hz and 600 Hz subcarriers alternate by minute:

**500 Hz minutes:** 4, 6, 12, 14, 16, 20, 22, 24, 26, 28, 32, 34, 36, 38, 40, 42, 52, 54, 56, 58

**600 Hz minutes:** 1, 3, 5, 7, 11, 13, 15, 17, 19, 21, 23, 25, 27, 31, 33, 35, 37, 39, 41, 53, 55, 57

**Silent minutes:** 0, 2, 8, 9, 10, 18, 29, 30, 43-51, 59

---

## Common Metadata Rows

Several CSV files include special rows for metadata and gain changes:

### META Row
Records RF parameter changes:
```
{time},{timestamp_ms},META,0,freq={hz} rate={hz} GR={db} LNA={state},0,0,0,0,0
```

### GAIN Row
Records display gain adjustments:
```
{time},{timestamp_ms},GAIN,0,display_gain={±db}dB,0,0,0,0,0
```

---

## File Locations

Default output location: `./bin/` (same directory as executable)

Files are created fresh on each run with headers. Previous data is overwritten.
